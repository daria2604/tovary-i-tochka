(()=>{"use strict";var t={};function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},e(t)}function o(t,e){for(var o=0;o<e.length;o++){var r=e[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,n(r.key),r)}}function r(t,e,o){return(e=n(e))in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function n(t){var o=function(t,o){if("object"!==e(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!==e(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"===e(o)?o:String(o)}function i(t){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}function s(t,e){for(var o=0;o<e.length;o++){var r=e[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,_(r.key),r)}}function u(){return u="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,o){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=a(t)););return t}(t,e);if(r){var n=Object.getOwnPropertyDescriptor(r,e);return n.get?n.get.call(arguments.length<3?t:o):n.value}},u.apply(this,arguments)}function c(t,e){return c=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},c(t,e)}function l(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function a(t){return a=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},a(t)}function _(t){var e=function(t,e){if("object"!==i(t)||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var r=o.call(t,"string");if("object"!==i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"===i(e)?e:String(e)}t.p="";var p=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&c(t,e)}(h,t);var e,o,r,n,p=(r=h,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=a(r);if(n){var o=a(this).constructor;t=Reflect.construct(e,arguments,o)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return l(t)}(this,t)});function h(t){var e,o,r,n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,h),o=l(e=p.call(this,t)),n=function(){e._options.forEach((function(t){t.addEventListener("click",(function(){return t}))}))},(r=_(r="_isChecked"))in o?Object.defineProperty(o,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):o[r]=n,e._form=e.popup.querySelector(".popup__form"),e._options=e.popup.querySelectorAll('input[name="radioButton"]'),e}return e=h,(o=[{key:"setEventListeners",value:function(){var t=this;u(a(h.prototype),"setEventListeners",this).call(this),this._isChecked(),this._form.addEventListener("submit",(function(e){e.preventDefault(),t.close()}))}}])&&s(e.prototype,o),Object.defineProperty(e,"prototype",{writable:!1}),h}(function(){function t(e){var o=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),r(this,"_handleEscClose",(function(t){"Escape"===t.key&&o.close()})),r(this,"_handleOverlayClose",(function(t){t.target.classList.contains("popup_opened")&&o.close()})),this.popup=document.querySelector(e),this._closeButton=this.popup.querySelector(".popup__close")}var e,n;return e=t,(n=[{key:"open",value:function(){this.popup.classList.add("popup_opened"),document.addEventListener("keydown",this._handleEscClose)}},{key:"close",value:function(){this.popup.classList.remove("popup_opened"),document.removeEventListener("keydown",this._handleEscClose)}},{key:"setEventListeners",value:function(){var t=this;this._closeButton.addEventListener("click",(function(){t.popup.classList.contains("popup_opened")&&t.close()})),document.addEventListener("mousedown",this._handleOverlayClose)}}])&&o(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}());function h(t){return h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},h(t)}function f(t,e){return f=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},f(t,e)}function m(t){return m=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},m(t)}var y=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&f(t,e)}(i,t);var e,o,r,n=(o=i,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=m(o);if(r){var n=m(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===h(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function i(t){var e=t.popupSelector;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),n.call(this,e)}return e=i,Object.defineProperty(e,"prototype",{writable:!1}),e}(p);function d(t){return d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},d(t)}function b(t,e){return b=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},b(t,e)}function v(t){return v=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},v(t)}var S=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&b(t,e)}(i,t);var e,o,r,n=(o=i,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=v(o);if(r){var n=v(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===d(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function i(t){var e=t.popupSelector;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),n.call(this,e)}return e=i,Object.defineProperty(e,"prototype",{writable:!1}),e}(p),w=[{_id:1,image:t.p+"5662ce4b74185ded5903.jpeg",name:"Футболка UZcotton мужская",color:"белый",size:56,warehouse:"Коледино WB",seller:{name:"OOO Вайлдберриз",number:"ОГРН: 555555555555",address:"129337, Москва, улица Красная Сосна, 2, корпус 1, стр. 1, помещение 2, офис 34"},newPrice:522,oldPrice:1051,currency:"сом",discount:{regularDiscount:"55%",customerDiscount:"10%"},quantity:10},{_id:2,image:t.p+"116706712ca3dcc35ae5.jpeg",name:"Силиконовый чехол картхолдер (отверстия) для карт, прозрачный кейс бампер на Apple iPhone XR, MobiSafe",color:"прозрачный",warehouse:"Коледино WB",seller:{name:"OOO Мегапрофстиль",number:"ОГРН: 5167746237148",address:"129337, Москва, улица Красная Сосна, 2, корпус 1, стр. 1, помещение 2, офис 34"},newPrice:10500,oldPrice:11500,currency:"сом",discount:{regularDiscount:"55%",customerDiscount:"10%"},quantity:500},{_id:3,image:t.p+"ce3baefe27ab09dfb038.jpeg",name:'Карандаши цветные Faber-Castell "Замок", набор 24 цвета, заточенные, шестигранные, Faber-Castell ',warehouse:"Коледино WB",seller:{name:"OOO Вайлдберриз",number:"ОГРН: 555555555555",address:"129337, Москва, улица Красная Сосна, 2, корпус 1, стр. 1, помещение 2, офис 34"},newPrice:247,oldPrice:475,currency:"сом",discount:{regularDiscount:"55%",customerDiscount:"10%"},quantity:2}];function E(t){return E="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},E(t)}function g(t,e){for(var o=0;o<e.length;o++){var r=e[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,n=function(t,e){if("object"!==E(t)||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var r=o.call(t,"string");if("object"!==E(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===E(n)?n:String(n)),r)}var n}var L=function(){function t(e,o){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._form=o,this._inputSelector=e.inputSelector,this._errorClassTemplate=e.errorClassTemplate,this._activeErrorClass=e.activeErrorClass,this._invalidInputClass=e.invalidInputClass,this._inputLabelTemplate=e.inputLabelTemplate,this._activeInputLabelClass=e.activeInputLabelClass,this._submitButtonSelector=e.submitButtonSelector,this._telephoneInputSelector=e.telephoneInputSelector,this._telephoneInput=this._form.querySelector(this._telephoneInputSelector),this._submitButton=this._form.querySelector(this._submitButtonSelector),this._inputList=Array.from(this._form.querySelectorAll(this._inputSelector))}var e,o;return e=t,(o=[{key:"_showLabel",value:function(t){this._label=this._form.querySelector("".concat(this._inputLabelTemplate).concat(t.name)),this._label.classList.add(this._activeInputLabelClass)}},{key:"_hideLabel",value:function(t){this._label=this._form.querySelector("".concat(this._inputLabelTemplate).concat(t.name)),this._label.classList.remove(this._activeInputLabelClass)}},{key:"_showInputError",value:function(t){this._errorText=this._form.querySelector("".concat(this._errorClassTemplate).concat(t.name)),this._errorText.classList.add(this._activeErrorClass),t.classList.add(this._invalidInputClass)}},{key:"_hideInputError",value:function(t){this._errorText=this._form.querySelector("".concat(this._errorClassTemplate).concat(t.name)),this._errorText.classList.remove(this._activeErrorClass),t.classList.remove(this._invalidInputClass)}},{key:"_isFocused",value:function(t){var e=this;t.addEventListener("input",(function(){e._showLabel(t),t.value||e._hideLabel(t)}))}},{key:"_formatPhoneNumber",value:function(){var t=this;this._telephoneInput.addEventListener("input",(function(){t._number=t._telephoneInput.value,t._number=t._number.replace(/\D/g,""),t._number=t._number.slice(0,30),t._formattedNumber="+";for(var e=0;e<t._number.length;e++)1===e?t._formattedNumber+=" ":4!==e&&7!==e&&9!==e&&11!==e||(t._formattedNumber+=" "),t._formattedNumber+=t._number[e];t._telephoneInput.value=t._formattedNumber}))}},{key:"_checkInputValidity",value:function(t){switch(this._errorText=this._form.querySelector("".concat(this._errorClassTemplate).concat(t.name)),t.name){case"name":t.value?(this._hideInputError(t),this._errorText.textContent=" "):(this._errorText.textContent="Укажите имя",this._showInputError(t));break;case"surname":t.value?(this._hideInputError(t),this._errorText.textContent=" "):(this._errorText.textContent="Введите фамилию",this._showInputError(t));break;case"email":t.value?t.validity.valid?(this._hideInputError(t),this._errorText.textContent=" "):(this._errorText.textContent="Проверьте адрес электронной почты",this._showInputError(t)):(this._errorText.textContent="Укажите электронную почту",this._showInputError(t));break;case"telephone":t.value?/^\+\d{1}\s\d{3}\s\d{3}\s\d{2}\s\d{2}$/.test(t.value)?(this._hideInputError(t),this._errorText.textContent=" "):(this._errorText.textContent="Формат: +9 999 999 99 99",this._showInputError(t)):(this._errorText.textContent="Укажите номер телефона",this._showInputError(t));break;case"inn":t.value?14!==t.value.length?(this._errorText.textContent="Проверьте ИНН",this._errorText.style.color="#F55123",this._showInputError(t)):(this._hideInputError(t),this._errorText.textContent=" "):(this._errorText.textContent="Укажите ИНН",this._errorText.style.color="#F55123",this._showInputError(t))}}},{key:"_showValidationResult",value:function(){var t=this;this._inputList.forEach((function(e){t._checkInputValidity(e)}))}},{key:"_setFocus",value:function(){var t=this;this._inputList.forEach((function(e){t._isFocused(e)}))}},{key:"enableValidation",value:function(){var t=this;this._submitButton.addEventListener("click",(function(){t._showValidationResult()})),this._form.addEventListener("submit",(function(t){t.preventDefault(),console.log("Form is valid and submitted!")})),this._setFocus(),this._formatPhoneNumber()}}])&&g(e.prototype,o),Object.defineProperty(e,"prototype",{writable:!1}),t}();function k(t){return k="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},k(t)}function C(t,e){for(var o=0;o<e.length;o++){var r=e[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,n=function(t,e){if("object"!==k(t)||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var r=o.call(t,"string");if("object"!==k(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===k(n)?n:String(n)),r)}var n}var O=function(){function t(e,o){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._data=e,this._template=o,this._image=e.image,this._name=e.name,this._color=e.color,this._size=e.size,this._price=e.newPrice,this._warehouse=e.warehouse,this._seller=e.seller.name,this._quantity=e.quantity,this._total=document.querySelector(".order__total-sum"),this._count=0,this._totalSum=0}var e,o;return e=t,(o=[{key:"_getTemplate",value:function(){return this._emptyItem=this._template.content.querySelector(".item").cloneNode(!0),this._emptyItem.cloneNode(!0)}},{key:"_toggleLike",value:function(){this._likeButton.classList.toggle("like-icon_active")}},{key:"_deleteItem",value:function(){this._item.remove(),this._item=null}},{key:"_showSellerTooltip",value:function(){this._sellerTooltip.classList.add("tooltip_visible")}},{key:"_hideSellerTooltip",value:function(){this._sellerTooltip.classList.remove("tooltip_visible")}},{key:"_showDiscountTooltip",value:function(){this._discountTooltip.classList.add("tooltip_visible")}},{key:"_hideDiscountTooltip",value:function(){this._discountTooltip.classList.remove("tooltip_visible")}},{key:"_updateCount",value:function(){this._countElement.value=this._count}},{key:"_updateSum",value:function(){this._sumElement.textContent=this._totalSum,this._total.textContent=this._totalSum}},{key:"_checkStock",value:function(){this._count<1?this._removeButton.disabled=!0:this._removeButton.disabled=!1,this._quantity<1?this._addButton.disabled=!0:this._addButton.disabled=!1}},{key:"_addItem",value:function(){this._count++,this._quantity--,this._totalSum=this._count*this._price,this._countElement.value=this._count,this._updateSum(),this._checkStock()}},{key:"_removeItem",value:function(){this._count--,this._quantity++,this._totalSum=this._count*this._price,this._countElement.value=this._count,this._updateSum(),this._checkStock()}},{key:"_setEventListeners",value:function(){this._likeButton=this._item.querySelector(".like-icon"),this._deleteButton=this._item.querySelector(".delete-icon"),this._sellerInfoIcon=this._item.querySelector(".item__seller-about"),this._oldPrice=this._item.querySelector(".item__price-old"),this._sellerTooltip=this._item.querySelector(".tooltip_type_store"),this._discountTooltip=this._item.querySelector(".tooltip_type_discount"),this._removeButton=this._item.querySelector(".counter__minus"),this._addButton=this._item.querySelector(".counter__plus"),this._likeButton.addEventListener("click",this._toggleLike.bind(this)),this._deleteButton.addEventListener("click",this._deleteItem.bind(this)),this._sellerInfoIcon.addEventListener("mouseover",this._showSellerTooltip.bind(this)),this._sellerInfoIcon.addEventListener("mouseout",this._hideSellerTooltip.bind(this)),this._oldPrice.addEventListener("mouseover",this._showDiscountTooltip.bind(this)),this._oldPrice.addEventListener("mouseout",this._hideDiscountTooltip.bind(this)),this._addButton.addEventListener("click",this._addItem.bind(this)),this._removeButton.addEventListener("click",this._removeItem.bind(this))}},{key:"renderItem",value:function(){return this._item=this._getTemplate(),this._itemImage=this._item.querySelector(".item__preview-image"),this._itemImage.src=this._image,this._itemImage.alt=this._name,this._itemName=this._item.querySelector(".item__name"),this._itemName.textContent=this._name,this._itemColor=this._item.querySelector(".item__color"),this._itemSize=this._item.querySelector(".item__size"),this._itemSizeMobile=this._item.querySelector(".item__preview-size"),this._itemPrice=this._item.querySelector(".item__price-new"),this._itemPrice.textContent=this._price,this._itemWarehouse=this._item.querySelector(".item__warehouse"),this._itemWarehouse.textContent=this._warehouse,this._itemSeller=this._item.querySelector(".item__seller-name"),this._itemSeller.textContent=this._seller,this._messageElement=this._item.querySelector(".item__counter-left"),this._countElement=this._item.querySelector(".counter__number"),this._sumElement=this._itemPrice,this._size?(this._itemSize.textContent="Размер: ".concat(this._size),this._itemSizeMobile.textContent=this._size):(this._itemSize.textContent="",this._itemSizeMobile.style.display="none"),this._color?this._itemColor.textContent="Цвет: ".concat(this._color):this._itemColor.textContent="",this._quantity<=2&&(this._messageElement.textContent="Осталось 2 шт."),this._setEventListeners(),this._item}}])&&C(e.prototype,o),Object.defineProperty(e,"prototype",{writable:!1}),t}(),T=document.querySelector(".form"),P=document.querySelector("#itemTemplate"),q=document.querySelector(".cart__accordion-button"),x=document.querySelector(".cart__items"),I=document.querySelector(".cart__accordion-button_type_absent"),j=document.querySelector(".cart__items_type_absent"),B=document.querySelector(".tooltip_type_delivery"),R=document.querySelector(".tooltip_type_delivery-cart"),D=document.querySelector(".shipping__text-accent"),z=document.querySelector(".order__shipping-accent"),N=document.querySelector("#orderPaymentCheckbox"),F=document.querySelector(".order__payment-caption"),V=document.querySelector(".order__submit-button"),W=document.querySelector(".order__heading-sum"),A=document.querySelector(".payment__edit-button"),M=document.querySelector(".order__payment-edit"),U=document.querySelector(".order__delivery-edit"),X=document.querySelector(".delivery__edit-button"),Z=new L({inputSelector:".receiver__input-field",errorClassTemplate:".error_type_",activeErrorClass:"error_active",invalidInputClass:"receiver__input-field_type_error",inputLabelTemplate:".receiver__label_type_",activeInputLabelClass:"receiver__label_active",submitButtonSelector:".order__submit-button",telephoneInputSelector:".receiver__input-field_type_telephone"},T),$=new S({popupSelector:".popup_type_payment"}),G=new y({popupSelector:".popup_type_delivery"});w.forEach((function(t){var e=new O(t,P);x.appendChild(e.renderItem())})),q.addEventListener("click",(function(){x.classList.toggle("cart__items_closed"),q.classList.toggle("cart__accordion-button_rotate")})),I.addEventListener("click",(function(){j.classList.toggle("cart__items_closed"),I.classList.toggle("cart__accordion-button_rotate")})),D.addEventListener("mouseenter",(function(){R.classList.add("tooltip_visible")})),D.addEventListener("mouseleave",(function(){R.classList.remove("tooltip_visible")})),z.addEventListener("mouseenter",(function(){B.classList.add("tooltip_visible")})),z.addEventListener("mouseleave",(function(){B.classList.remove("tooltip_visible")})),N.addEventListener("change",(function(){F.classList.toggle("payment__caption_hidden"),N.checked?V.textContent="Оплатить ".concat(W.textContent):V.textContent="Заказать"})),A.addEventListener("click",(function(){$.open()})),M.addEventListener("click",(function(){$.open()})),X.addEventListener("click",(function(){G.open()})),U.addEventListener("click",(function(){G.open()})),$.setEventListeners(),G.setEventListeners(),Z.enableValidation()})();